Fig 4. Architecture of scalar multiplying module
0 1 ,ZI = T 3 if (I != 0 and k, != k 1-1) or (I = 0 and k, = 1) then Swap(X I,X2), Swap(ZI, Z2) end if end for A very small amount of clock cycles is required to read and write the temporary data to and fro Block MM. The architecture of the coprocessor is shown in Figure 3, in which Mod Mult is instantiated modular multiplication module in Verilog description, X 3, Z3 and Qout are 233- bit wide register, Add Logic Control and Double Logic Control are operation process finite state machine module.  On the field of arithmetic operation over GF(i 33 ) , the coprocessor can achieve two different point adding operation, point doubling operation and two point subtracting operation and so on.  To improve computing performance the data bus inside coprocessor is 233 -bit wide.  All the computing operation is controlled by finite state machine.  V. SCALAR MULTIPLICATION Many scalar multiplication algorithms for certain elliptic curve have been proposed, such as binary method, non-adjacent form (NAF) method, slide window NAF method, fixed comb method, Montgomery method, etc.  Among these algorithms, the NAF method, without pre­ computing, is more suitable for hardware implementation for its concision and efficiency.  The following NAF algorithm is adopted in our design of coprocessor.  The architecture of scalar multiplying module in FPGA device is depicted as Figure 4. l.set hlhl-I ...hIho is binary representation of3k.  2.set klkl-l...kIko is binary representation ofk.  3.set S=Q. 4.For i from 1-1 down to 1do 4. 1 set S = 2S. 4.2 if (hi=1 && ki=O) S=S+Q; 4. 3 if (hi=O && ki=l) S=S-Q; 978-1-4244-4787-9/09/$25. 00 ©2009 IEEE 36 Fig 4. Architecture of scalar multiplying module For example, two different elliptic curve points addition requires 9 field multiplications in mixed coordinate system, one is affine coordinate system and the other is LD projective coordinate system.  A point doubling require 4 field multiplications and each multiplication requires [233/2] =117 clock cycles in GF(i 33 ) . 

