Fig. 3. Internal model control (IMC) scheme.manipulated variable u from performing vast changes.
 This can be a very lengthy procedure since the inﬂuence of the controller parameters on the control performance cannot easily be described.  Also, the parameters itself do not have a physical interpretation which makes the tuning non-intuitive.  In order to assist the process engineer, the controller parameters can be automatically optimized based on a given process model by minimizing a predeﬁned cost function, e.g. the quadratic cost function J = ∞  k=0 e(k) 2 + β ∞  k=0 ∆ u(k) 2 , (8) which expresses the control objectives.  The ﬁrst sum penalizes the control error e(k)= r(k) − y(k). Fig. 3. Internal model control (IMC) scheme. manipulated variable u from performing vast changes. β is the penalty factor for changes of the manipulated variable ∆ u. The optimization of the cost function (8), however, is in general nonlinear and computationally expensive.  Also, the choice of the tuning parameter β is strongly dependent on the process to be controlled and hence difﬁcult to adjust.  In case of local model systems, local conventional controllers can individually be designed and blended to an overall nonlinear gain-scheduled controller.  3.2 Internal Model Control Design Figure 3 shows the standard linear IMC scheme (Morari and Zaﬁriou, 1989) where the process model G P0 plays an explicit role in the control struc- ture compared to the standard control loop.  The IMC structure has some advantages over conventional feed- back control loops.  For the nominal case G P = G P0 , for instance, the feedback is affected only by the dis- turbance d such that the system is effectively open loop and hence no stability problems can arise.  Also, if the process G P is stable, which is true for most indus- trial processes, the closed loop will be stable for any stable controller G Q .  Furthermore, the controller G Q can simply be designed as a feedforward controller in the IMC scheme.  The IMC design procedure consists of two steps (Morari and Zaﬁriou, 1989).  Since G Q can be designed as an open-loop controller, the ideal choice for the controller is the inverse of the process model G  Q = G −1 P0 , (9) which will yield good tracking and disturbance rejec- tion. 

