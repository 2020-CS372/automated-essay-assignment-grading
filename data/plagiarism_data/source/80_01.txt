Figure 3. Architecture of point operation module
  5. Output(X 3 , Y 3 , Z 3 ).   The elliptic subtraction is implemented as follows.   Subtract[(X 1 ,Y 1 ,Z 1 ),(X 2 ,Y 2 ,Z 2 )]  =FullAdd[(X 1 ,Y 1 ,Z 1 ),(X 2 ,U,Z 2 )]  Where U = X 2 Z 2 + Y 2 .   With modular addition, modular squaring and modu- lar multiplication arithmetic implemented in FPGA device,  the point addition module inside coprocessor can be de- signed.  The addition of two different points operation  requires nine 233-bit wide temporary registers.  These  registers can be implemented in Block RAM inside FPGA  Third International Conference on Natural Computation (ICNC 2007) 0-7695-2875-9/07 $25. 00  © 2007device. A very small amount of clock cycles is required to  read and write the temporary data to and fro Block Ram.   The architecture of the coprocessor is shown in Figure 3,  in which Mod Mult is instantiated modular multiplication  module in Verilog description, X3, Z3 and Qout are 233- bit wide register, Add Logic Control and Double Logic  Control are operation process finite state machine module. Figure 3. Architecture of point operation module  On the field of arithmetic operation over GF(2 233 ) ,  the coprocessor can achieve two different point adding  operation, point doubling operation and two point sub- tracting operation and so on. To improve computing per- formance the data bus inside coprocessor is 233-bit wide.   All the computing operation is controlled by finite state  machine.      5. Scalar multiplication    Many scalar multiplication algorithms for certain el- liptic curve have been proposed, such as binary method,  non-adjacent form (NAF) method, slide window NAF  method, fixed comb method, Montgomery method, etc.   Among these algorithms, the NAF method, without pre- computing, is more suitable for hardware implementation  for its concision and efficiency.  The following NAF algo- rithm is adopted in our design of coprocessor.  The archi- tecture of scalar multiplying module in FPGA device is  depicted as Figure 4.  1.set h l h l–1 ...h 1 h 0  is binary representa- tion of 3k. 

